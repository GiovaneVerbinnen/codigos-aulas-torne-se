<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
    integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous" />
  <link rel="stylesheet" href="../highlight/styles/monokai-sublime.min.css" />
  <script src="../highlight/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  <title>Document</title>
</head>

<body>
  <section class="container">
    <div class="my-5">
      <!-- Aula Teórica -->
      <h2>Metaprogramming - Dinâmicos </h2>
      <br />





      <hr>
      <p>Arquivo final:</p>
      <pre class="m-0">
        <code class="language-ruby rounded">
          require 'byebug'

          #lambda não aceita mais parametros do que os definidos
          #lambda retorno dentro do proprio lambda
          l = lambda {|param| param * 5}
          puts l.call(4)
          
          l = lambda do |p1, p2| 
            p1 + p2
          end
          puts l.call(4, 5)
          
          
          # puts "ini"
          # def method
          #   puts "indi"
          #   l = lambda {return "s"}
          #   puts l.call
          #   puts "inei"
          # end
          # method
          # puts "fim"
          
          ########################################################
          #lambda aceita mais parametros do que os definidos
          #lambda retorno do metodo inteiro
          
          l = Proc.new do |param, p2, p3|
            puts param
            puts p2
            puts p3
          end
          
          l.call(4)
          
          
          
          # puts "ini"
          # def method
          #   puts "indi"
          #   l = Proc.new {return "dd"}
          #   puts l.call
          #   puts "inei"
          # end
          # method
          # puts "fim"
          
          ########################################################
          
          def metodo_para_definir_bloco(&bloco)
            bloco
          end
          
          l = metodo_para_definir_bloco do |param| 
            param * 5
          end
          
          
          puts l.call(4)
          
          l = metodo_para_definir_bloco do 
            puts "danilo"
          end
          
          # debugger
          
          l.call
          
          # debugger
          
          ########################################################
          # convert string na linguagem
          eval "puts 'danilo'"
          ########################################################
          
          atr = "danilo"
          
          eval("
            def #{atr}(value)
              @#{atr} = value
            end
          ")
          
          eval("
            def mostra
              @#{atr}
            end
          ")
          
          danilo('dssds')
          mostra
          
          
          ########################################################
          
          #definindo metodos dinamicos
          
          class Teste
            def inicio
              def fim
              end
            end
          end
          
          t = Teste.new
          # t.fim
          t.inicio
          t.fim
          
          ########################################################
          
          class Teste
            def self.definir(valor)
              define_method(valor) do |param1, param2|
                puts "#{param1} - #{param2}"
              end
            end
          
            def self.atributo(valor)
              define_method(valor) do |param1|
                puts param1
              end
            end
          end
          
          ['set_nome', 'set_telefone', 'set_endereco'].each do |atr|
            Teste.atributo(atr)
          end
          
          teste = Teste.new
          
          
          # Teste.new.novo_metodo('danilo', 'que legal')
          
          ########################################################
          module AtributosDinamicos
            def atributos(*atrs)
              atrs.each do |atr|
                define_method("#{atr}=") do |value|
                  instance_variable_set "@#{atr}", value
                end
          
                define_method("#{atr}") do
                  instance_variable_get "@#{atr}"
                end
              end
            end
          
            def atributos_somente_leitura(*atrs)
              atrs.each do |atr|
                define_method("#{atr}") do
                  instance_variable_get "@#{atr}"
                end
              end
            end
          end
          
          class Teste
            extend AtributosDinamicos
            atributos :nome, :telefone, :cpf
            # atributos_somente_leitura :nome, :telefone, :cpf
            # attr_accessor :nome, :telefone
          end
          
          t = Teste.new
          # debugger
          t.nome = "danilo"
          t.telefone = "3334343"
          
          
          puts "#{t.nome}, #{t.telefone}"
          
          
          # debugger
          
          
          
          x = ""
        </code>
      </pre>
      <!-- FIM -->
      <br />
    </div>
  </section>
</body>

</html>